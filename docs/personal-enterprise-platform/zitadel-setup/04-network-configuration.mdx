---
title: Network Configuration
sidebar_position: 4
tags:
  - Network
  - Domain
  - HTTPS
  - Reverse Proxy
---

# Network Configuration

## 1. External Domain Setup

**Note**: External domain configuration is covered in the [Post-Installation](03-post-installation.mdx#41-set-external-domain) section. Please follow those steps first before proceeding with network configuration.

## 2. Pangolin Integration

When using Pangolin as your access method, no additional reverse proxy configuration is needed. The Pangolin resource you created in the post-installation steps handles the secure tunneling to your private LAN.

### 2.1 Troubleshooting Access Issues

If you're still getting an Internal Server Error after setting up the Pangolin resource and configuring the external domain:

1. **Verify Zitadel Service Status**:
   ```bash
   systemctl status zitadel
   ```

2. **Check Zitadel Logs**:
   ```bash
   journalctl -u zitadel -n 50 --no-pager
   ```

3. **Verify External Domain Configuration**:
   - Ensure `ExternalDomain: auth.kylehub.dev` is set in `/opt/zitadel/config.yaml`
   - Ensure `ExternalSecure: false` is set (when using Pangolin)
   - Confirm the rerun script was executed successfully

4. **Check Pangolin Resource Configuration**:
   - Verify the resource is created with the correct IP (192.168.1.51) and port (8080)
   - Ensure the resource type is `HTTP Resource` (not HTTPS)
   - Ensure the method/protocol is `http` (not https)
   - Ensure the subdomain is set to `auth` or your configured subdomain
   - Confirm the resource is active and not paused

5. **Check Pangolin Resource**:
   - Ensure the resource allows API calls (some tunneling solutions need specific configuration for API endpoints)
   - Try accessing the API directly: `https://auth.kylehub.dev/oauth/v2/keys`
   - If API calls fail but the main interface loads, Pangolin may need additional configuration for API routes

6. **Test API Endpoints Directly**:
   ```bash
   # Test various API endpoints
   curl -i https://auth.kylehub.dev/oauth/v2/keys
   curl -i https://auth.kylehub.dev/oidc/v1/userinfo
   curl -i https://auth.kylehub.dev/debug/healthz
   ```
   These should return valid responses, not connection errors.

6. **Check Network Listening**:
   ```bash
   # Check what ports Zitadel is listening on
   ss -tlnp | grep :8080
   
   # Check if port 8080 is accessible from host
   curl http://localhost:8080/ui/console
   ```

7. **Restart Services if Needed**:
   ```bash
   systemctl restart zitadel
   ```

### 2.1.2 Frontend API Communication Issues

If you get "[unknown] Failed to fetch" errors in the Zitadel console (especially on pages like `/users/me`) or when trying to access container commands:

**This indicates the frontend cannot communicate with the Zitadel API or container access is blocked.**

**For Pangolin users**, this can happen due to API endpoint configuration or resource restrictions. Try these fixes:

1. **Check API Endpoint Configuration**:
   ```bash
   # In the container console
   nano /opt/zitadel/config.yaml
   ```
   
   Ensure you have the correct API configuration:
   ```yaml
   ExternalDomain: auth.kylehub.dev
   ExternalSecure: false
   Port: 8080
   ExternalPort: 8080
   ```

2. **Restart Zitadel**:
   ```bash
   systemctl restart zitadel
   ```

3. **Clear Browser Cache**:
   - Hard refresh (Ctrl+F5 or Cmd+Shift+R)
   - Clear browser cache for the domain

4. **Check Pangolin Resource**:
   - Ensure the resource allows API calls (some tunneling solutions need specific configuration for API endpoints)
   - Try accessing the API directly: `https://auth.kylehub.dev/oauth/v2/keys`
   - **Important**: Verify that Pangolin allows WebSocket connections and long-running requests

5. **Alternative: Direct Container Access**:
   If Pangolin blocks console access, use Proxmox directly:
   ```bash
   # From Proxmox host (not through Pangolin)
   pct enter 201
   # Then run your commands
   journalctl -u zitadel -f | grep -i "verification\|code\|email"
   ```

6. **Test API Endpoints Directly**:
   ```bash
   # Test various API endpoints
   curl -i https://auth.kylehub.dev/oauth/v2/keys
   curl -i https://auth.kylehub.dev/oidc/v1/userinfo
   curl -i https://auth.kylehub.dev/debug/healthz
   ```
   These should return valid responses, not connection errors.

7. **Debug Network Connectivity**:
   ```bash
   # From Proxmox host, test container connectivity
   pct exec 201 -- curl -s http://localhost:8080/debug/healthz
   pct exec 201 -- systemctl status zitadel
   ```

If the direct access works but Pangolin doesn't, the issue is likely with how Pangolin handles API requests or console access.

### 2.2 Alternative Access Methods

If you prefer not to use Pangolin, you can set up traditional reverse proxy solutions:

#### Nginx Configuration
```nginx
server {
    listen 443 ssl http2;
    server_name auth.yourdomain.com;

    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    location / {
        proxy_pass http://192.168.1.51:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

#### Traefik Configuration
```yaml
http:
  routers:
    zitadel:
      rule: "Host(`auth.yourdomain.com`)"
      service: zitadel
      tls:
        certResolver: letsencrypt

  services:
    zitadel:
      loadBalancer:
        servers:
        - url: "http://192.168.1.51:8080"
```